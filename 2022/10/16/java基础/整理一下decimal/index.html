<!DOCTYPE html><html lang="zh_CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>decimal整理 | 每天进步一点点</title><meta name="author" content="issac"><meta name="copyright" content="issac"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="本文部分内容转载自：https:&amp;#x2F;&amp;#x2F;www.hollischuang.com&amp;#x2F;archives&amp;#x2F;5559 ​									  https:&amp;#x2F;&amp;#x2F;www.hollischuang.com&amp;#x2F;archives&amp;#x2F;6137 数据库中金额单位一般存法？存分：int类型 存元：decimal(28,6)  小数"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://issac2e.github.io/2022/10/16/java%E5%9F%BA%E7%A1%80/%E6%95%B4%E7%90%86%E4%B8%80%E4%B8%8Bdecimal/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'decimal整理',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-02-08 05:58:33'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = url => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      link.onload = () => resolve()
      link.onerror = () => reject()
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/./img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/./img/preview5.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="每天进步一点点"><span class="site-name">每天进步一点点</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">decimal整理</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-10-16T21:02:08.000Z" title="Created 2022-10-16 22:02:08">2022-10-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-02-08T05:58:33.349Z" title="Updated 2023-02-08 05:58:33">2023-02-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/java%E5%9F%BA%E7%A1%80/">java基础</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="decimal整理"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>本文部分内容转载自：<a target="_blank" rel="noopener" href="https://www.hollischuang.com/archives/5559">https://www.hollischuang.com/archives/5559</a></p>
<p>​									  <a target="_blank" rel="noopener" href="https://www.hollischuang.com/archives/6137">https://www.hollischuang.com/archives/6137</a></p>
<h1 id="数据库中金额单位一般存法？"><a href="#数据库中金额单位一般存法？" class="headerlink" title="数据库中金额单位一般存法？"></a>数据库中金额单位一般存法？</h1><p>存分：int类型</p>
<p>存元：decimal(28,6)  小数点前28位,小数点后6位</p>
<h5 id="有币种吗？如果要支持多币种，需要做什么改造吗？"><a href="#有币种吗？如果要支持多币种，需要做什么改造吗？" class="headerlink" title="有币种吗？如果要支持多币种，需要做什么改造吗？"></a><strong>有币种吗？如果要支持多币种，需要做什么改造吗？</strong></h5><p>存储金额以元为单位：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">amt <span class="type">Decimal</span>(<span class="number">28</span>,<span class="number">6</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">currencyCode <span class="type">CHAR</span>(<span class="number">3</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br></pre></td></tr></table></figure>

<p>因为货币可能有不同的小数位数（2 代表<code>EUR</code>，<code>USD</code>等等，但 0 代表<code>JPY</code>，3 代表<code>CNY</code>…），建议将金额以<em><strong>次要货币单位</strong></em>（美分）存储为整数。因此，您的表格将如下所示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">amount <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">currencyCode <span class="type">CHAR</span>(<span class="number">3</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br></pre></td></tr></table></figure>

<p>如果您想存储<code>12.34 USD</code>，您实际上将存储<code>(1234, &#39;USD&#39;)</code>。</p>
<h5 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h5><ol>
<li>金额运算尽量使用BigDecimal(String val)进行运算。</li>
<li>数据库存储金额，一般有<strong>整型和浮点型两种存储方式</strong>。如果是<strong>有汇率转换的</strong>，<strong>建议使用浮点数decimal进行存储，可以灵活的控制精度</strong>，decimal直接对应java类型BigDecimal。当然，用整数存储分这种形式也可以，转账的时候单位为元要记得将分为元。</li>
</ol>
<h1 id="Decimal"><a href="#Decimal" class="headerlink" title="Decimal"></a>Decimal</h1><p>一般放代码里面进行处理，所以会用到deciaml类，下面复习相关用法：</p>
<p><strong>Double类型造成结果与期望值有偏差，所以改用decimal类型进行计算</strong></p>
<h5 id="1、decimal在java中的用BigDecimal表示，java-math包下"><a href="#1、decimal在java中的用BigDecimal表示，java-math包下" class="headerlink" title="1、decimal在java中的用BigDecimal表示，java.math包下"></a>1、decimal在java中的用BigDecimal表示，java.math包下</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Column(length=10 ,scale=2)</span>    <span class="comment">// length表示长度 ， scale表示小数点后位数</span></span><br><span class="line"><span class="keyword">private</span> BigDecimal money;</span><br></pre></td></tr></table></figure>

<h5 id="2、BigDecimal类型与string，Double类型的相互转换"><a href="#2、BigDecimal类型与string，Double类型的相互转换" class="headerlink" title="2、BigDecimal类型与string，Double类型的相互转换"></a>2、BigDecimal类型与string，Double类型的相互转换</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">BigDecimal</span> <span class="variable">bd</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="string">&quot;xxx&quot;</span>);</span><br><span class="line"><span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> bd.toString();</span><br><span class="line"></span><br><span class="line">Double a=<span class="number">1.23</span>;</span><br><span class="line"><span class="type">BigDecimal</span> <span class="variable">c</span> <span class="operator">=</span> BigDecimal.valueOf(a);</span><br><span class="line">BigDecimal bd;</span><br><span class="line"><span class="type">double</span> <span class="variable">d</span> <span class="operator">=</span> bd.doubleValue();</span><br><span class="line">不能使用：有误差</span><br><span class="line">BigDecimal decimal= <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(a);</span><br></pre></td></tr></table></figure>

<p><strong>double小数转bigdecimal后四舍五入计算有误差</strong></p>
<p>案例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> g= <span class="number">12.35</span>;  </span><br><span class="line">BigDecimal bigG=<span class="keyword">new</span> <span class="title class_">BigDecimal</span>(g).setScale(<span class="number">1</span>, BigDecimal.ROUND_HALF_UP); <span class="comment">//期望得到12.4</span></span><br><span class="line">System.out.println(<span class="string">&quot;test G:&quot;</span>+bigG.doubleValue()); </span><br><span class="line">输出 ：test G: <span class="number">12.3</span> </span><br></pre></td></tr></table></figure>

<p>原因：</p>
<p>定义double g&#x3D; 12.35 ;  而在计算机中二进制表示可能这是样：定义了一个g&#x3D;12.34444444444444449，<br>new BigDecimal(g)   g还是12.34444444444444449<br>new BigDecimal(g).setScale(1, BigDecimal.ROUND_HALF_UP);  得到12.3<br><strong><font color="#dd0000">正确的定义方式是使用字符串构造函数：</font></strong><br>new BigDecimal(“12.35”).setScale(1, BigDecimal.ROUND_HALF_UP)</p>
<h5 id="3、BigDecimal操作运算加减乘除"><a href="#3、BigDecimal操作运算加减乘除" class="headerlink" title="3、BigDecimal操作运算加减乘除"></a>3、BigDecimal操作运算加减乘除</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">BigDecimal</span> <span class="variable">num1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="string">&quot;100&quot;</span>);  </span><br><span class="line"><span class="type">BigDecimal</span> <span class="variable">num2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="string">&quot;50&quot;</span>);</span><br><span class="line"><span class="comment">//加法</span></span><br><span class="line"><span class="type">BigDecimal</span> <span class="variable">result1</span> <span class="operator">=</span> num1.add(num2);        </span><br><span class="line"><span class="comment">//减法 </span></span><br><span class="line"><span class="type">BigDecimal</span> <span class="variable">result2</span> <span class="operator">=</span> num1.subtract(num2);</span><br><span class="line"><span class="comment">//乘法</span></span><br><span class="line"><span class="type">BigDecimal</span> <span class="variable">result3</span> <span class="operator">=</span> num1.multiply(num2);      </span><br><span class="line"><span class="comment">//除法</span></span><br><span class="line"><span class="type">BigDecimal</span> <span class="variable">result4</span> <span class="operator">=</span> num1.divide(num2);</span><br></pre></td></tr></table></figure>

<h5 id="4、阿里巴巴禁止使用BigDecimal的equals方法做等值比较"><a href="#4、阿里巴巴禁止使用BigDecimal的equals方法做等值比较" class="headerlink" title="4、阿里巴巴禁止使用BigDecimal的equals方法做等值比较"></a>4、阿里巴巴禁止使用BigDecimal的equals方法做等值比较</h5><p><img src="/images/Snipaste_2023-02-07_15-27-37.png" alt="阿里巴巴规范"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">错误写法：</span><br><span class="line"><span class="keyword">if</span>(bigDecimal == bigDecimal1)&#123;</span><br><span class="line">    <span class="comment">// 两个数相等</span></span><br><span class="line">&#125;</span><br><span class="line">解释：因为BigDecimal是对象，所以不能用==来判断两个数字的值是否相等。</span><br><span class="line"><span class="keyword">if</span>(bigDecimal.equals(bigDecimal1))&#123;</span><br><span class="line">    <span class="comment">// 两个数相等</span></span><br><span class="line">&#125;</span><br><span class="line">实验：</span><br><span class="line"><span class="type">BigDecimal</span> <span class="variable">bigDecimal</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="number">1</span>);</span><br><span class="line"><span class="type">BigDecimal</span> <span class="variable">bigDecimal1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="number">1</span>);</span><br><span class="line">System.out.println(bigDecimal.equals(bigDecimal1));</span><br><span class="line"></span><br><span class="line"><span class="type">BigDecimal</span> <span class="variable">bigDecimal2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="number">1</span>);</span><br><span class="line"><span class="type">BigDecimal</span> <span class="variable">bigDecimal3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="number">1.0</span>);</span><br><span class="line">System.out.println(bigDecimal2.equals(bigDecimal3));</span><br><span class="line"></span><br><span class="line"><span class="type">BigDecimal</span> <span class="variable">bigDecimal4</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="string">&quot;1&quot;</span>);</span><br><span class="line"><span class="type">BigDecimal</span> <span class="variable">bigDecimal5</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="string">&quot;1.0&quot;</span>);</span><br><span class="line">System.out.println(bigDecimal4.equals(bigDecimal5));</span><br><span class="line">输出：</span><br><span class="line">    <span class="literal">true</span></span><br><span class="line">    <span class="literal">true</span></span><br><span class="line">    <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p><strong>BigDecimal的equals原理</strong></p>
<p>通过以上代码示例，我们发现，在使用BigDecimal的equals方法对1和1.0进行比较的时候，有的时候是true（当使用int、double定义BigDecimal时），有的时候是false（当使用String定义BigDecimal时）。</p>
<p><strong>在BigDecimal的JavaDoc中其实已经解释了其中原因：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BigDecimal的equals方法 Compares this  BigDecimal with the specified Object for equality.  </span><br><span class="line">Unlike compareTo, this method considers two BigDecimal objects equal only if they are equal in value and scale (thus 2.0 is not equal to 2.00 when compared by  this method)</span><br></pre></td></tr></table></figure>

<p>两个BigDecimal对象（bigDecimal4和bigDecimal5）的标度是不一样的，所以使用equals比较的结果就是false了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">首先，BigDecimal一共有以下4个构造方法：</span><br><span class="line">BigDecimal(int)</span><br><span class="line">BigDecimal(double) </span><br><span class="line">BigDecimal(long) </span><br><span class="line">BigDecimal(String)</span><br></pre></td></tr></table></figure>

<p>以上四个方法，创建出来的的BigDecimal的标度是不同的。</p>
<p>1、首先，最简单的就是<strong>BigDecimal(long) 和BigDecimal(int)，因为是整数，所以标度就是0</strong> 。</p>
<p>2、 而对于BigDecimal(double) ，<strong>当我们使用new BigDecimal(0.1)创建一个BigDecimal 的时候，其实创建出来的值并不是整好等于0.1的，而是0.1000000000000000055511151231257827021181583404541015625 。这是因为doule自身表示的只是一个近似值。</strong></p>
<p>那么，无论我们使用new BigDecimal(0.1)还是new BigDecimal(0.10)定义，他的近似值都是0.1000000000000000055511151231257827021181583404541015625这个，那么<em><strong>他的标度就是这个数字的位数</strong></em>，即55。其他的浮点数也同样的道理。对于new BigDecimal(1.0)这样的形式来说，因为他本质上也是个整数，<strong>所以他创建出来的数字的标度就是0。</strong></p>
<p>所以，因为BigDecimal(1.0)和BigDecimal(1.00)的标度是一样的，所以在使用equals方法比较的时候，得到的结果就是true。</p>
<p>3、BigDecimal(string) ，<strong>当我们使用new BigDecimal(“0.1”)创建一个BigDecimal 的时候，其实创建出来的值正好就是等于0.1的。那么他的标度也就是1。</strong></p>
<p>如果使用new BigDecimal(“0.10000”)，那么创建出来的数就是0.10000，标度也就是5。</p>
<p>所以，因为BigDecimal(“1.0”)和BigDecimal(“1.00”)的标度不一样，所以在使用equals方法比较的时候，得到的结果就是false。</p>
<h5 id="5、如何比较BigDecimal"><a href="#5、如何比较BigDecimal" class="headerlink" title="5、如何比较BigDecimal"></a>5、如何比较BigDecimal</h5><p>BigDecimal中提供了compareTo方法，这个方法就可以只比较两个数字的值，如果两个数相等，则返回0。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">BigDecimal</span> <span class="variable">bigDecimal4</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="string">&quot;1&quot;</span>);</span><br><span class="line"><span class="type">BigDecimal</span> <span class="variable">bigDecimal5</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="string">&quot;1.0000&quot;</span>);</span><br><span class="line">System.out.println(bigDecimal4.compareTo(bigDecimal5));</span><br><span class="line">输出：<span class="number">0</span></span><br></pre></td></tr></table></figure>



<h5 id="6、为什么说double不精确？"><a href="#6、为什么说double不精确？" class="headerlink" title="6、为什么说double不精确？"></a>6、为什么说double不精确？</h5><p><img src="/images/Snipaste_2023-02-07_16-54-25.png" alt="double转bigdecimal"></p>
<p>首先，<strong>计算机是只认识二进制的</strong>，即0和1，这个大家一定都知道。</p>
<p>那么，所有数字，包括整数和小数，想要在计算机中存储和展示，都需要转成二进制。</p>
<p><strong>十进制整数转成二进制很简单，通常采用”除2取余，逆序排列”即可，如10的二进制为1010。</strong></p>
<p>但是，小数的二进制如何表示呢？</p>
<p>十进制小数转成二进制，一般采用”<strong>乘2取整，顺序排列</strong>”方法，如0.625转成二进制的表示为0.101。</p>
<p>但是，**<font color="#dd0000">并不是所有小数都能转成二进制</font>**，如0.1就不能直接用二进制表示，他的二进制是0.000110011001100… 这是一个无限循环小数。</p>
<p><strong>所以，计算机是没办法用二进制精确的表示0.1的。也就是说，在计算机中，很多小数没办法精确的使用二进制表示出来。</strong></p>
<p>那么，这个问题总要解决吧。那么，<strong>人们想出了一种采用一定的精度，使用近似值表示一个小数的办法</strong>。这就是IEEE 754（IEEE二进制浮点数算术标准）规范的主要思想。</p>
<p>IEEE 754规定了多种表示浮点数值的方式，其中最常用的就是32位单精度浮点数和64位双精度浮点数。</p>
<p>在Java中，使用float和double分别用来表示<strong>单精度浮点数和双精度浮点数。</strong></p>
<p>所谓精度不同，可以简单的理解为保留有效位数不同。采用保留有效位数的方式近似的表示小数。</p>
<h5 id="7、BigDecimal如何精确计数？"><a href="#7、BigDecimal如何精确计数？" class="headerlink" title="7、BigDecimal如何精确计数？"></a>7、BigDecimal如何精确计数？</h5><p>如果大家看过BigDecimal的源码，其实可以发现，<strong>实际上一个BigDecimal是通过一个”无标度值”和一个”标度”来表示一个数的。</strong></p>
<p>在BigDecimal中，标度是通过<strong>scale字段</strong>来表示的。</p>
<p>而无标度值的表示比较复杂。当unscaled value超过阈值(默认为Long.MAX_VALUE)时采用<strong>intVal字段</strong>存储unscaled value，intCompact字段存储Long.MIN_VALUE，否则对unscaled value进行压缩存储到<strong>long型</strong>的intCompact字段用于后续计算，intVal为空。</p>
<p>涉及到的字段就是这几个：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public class BigDecimal extends Number implements Comparable&lt;BigDecimal&gt; &#123;</span><br><span class="line">    private final BigInteger intVal;</span><br><span class="line">    private final int scale; </span><br><span class="line">    private final transient long intCompact;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如123.123，那么如果使用BigDecimal表示，那么他的无标度值为123123，他的标度为3。</p>
<h5 id="8、总结"><a href="#8、总结" class="headerlink" title="8、总结"></a>8、总结</h5><p>因为计算机采用二进制处理数据，但是很多小数，如0.1的二进制是一个无线循环小数，而这种数字在计算机中是无法精确表示的。</p>
<p>所以，人们采用了一种通过近似值的方式在计算机中表示，于是就有了<strong>单精度浮点数和双精度浮点数</strong>等。</p>
<p>所以，作为单精度浮点数的float和双精度浮点数的double，在<strong>表示小数的时候只是近似值，并不是真实值</strong>。</p>
<p>所以，<strong>当使用BigDecimal(Double)创建一个的时候，得到的BigDecimal是损失了精度的。</strong></p>
<p>而使用一个损失了精度的数字进行计算，得到的结果也是不精确的。</p>
<p>想要避免这个问题，可以通过**BigDecimal(String)**的方式创建BigDecimal，这样的情况下，0.1就会被精确的表示出来。</p>
<p>其表现形式是一个<strong>无标度数值1，和一个标度1的组合</strong>。</p>
<h1 id="贴段代码"><a href="#贴段代码" class="headerlink" title="贴段代码"></a>贴段代码</h1><p>.stripTrailingZeros().toPlainString();</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span> <span class="comment">//可以省去代码中大量的get()、 set()、 toString()等方法；</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">Lombok本质上就是一个实现了“JSR 269 API”的程序。在使用javac的过程中，它产生作用的具体流程如下：</span></span><br><span class="line"><span class="comment">    javac对源代码进行分析，生成了一棵抽象语法树（AST）</span></span><br><span class="line"><span class="comment">    运行过程中调用实现了“JSR 269 API”的Lombok程序</span></span><br><span class="line"><span class="comment">    此时Lombok就对第一步骤得到的AST进行处理，找到<span class="doctag">@Data</span>注解所在类对应的语法树（AST），</span></span><br><span class="line"><span class="comment">    然后修改该语法树（AST），增加getter和setter方法定义的相应树节点</span></span><br><span class="line"><span class="comment">    javac使用修改后的抽象语法树（AST）生成字节码文件，即给class增加新的节点（代码块）</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span> <span class="comment">// 注在类上，提供类的全参构造</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span> <span class="comment">// 注在类上，提供类的无参构造</span></span><br><span class="line"><span class="meta">@ApiModel(&quot;xxx&quot;)</span> <span class="comment">//测试</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode(callSuper =false)</span></span><br><span class="line"><span class="meta">@Log4j</span>/<span class="meta">@Slf4j</span> <span class="comment">// 注在类上，提供对应的 Logger 对象，变量名为 log</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CashAndPositionVO</span> enxtends CashAndPositionEntity&#123;</span><br><span class="line">    <span class="keyword">private</span> Decimal amt;</span><br><span class="line">    <span class="comment">// 需要返回金额的字符串，这个字段无需再建，通过现有字段拓展展示即可</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAmtStr</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(ObjectUtils.isEmpty(<span class="built_in">this</span>.getAmt()))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;        </span><br><span class="line">        &#125;    </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.getAmt().stripTrailingZeros().toPlainString();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">        BigDecimal虽然相对double和float会降低性能，但是处理浮点数的时候不会丢失精度。</span></span><br><span class="line"><span class="comment">        BigDecimal的stripTrailingZeros()是去掉多余的0，</span></span><br><span class="line"><span class="comment">        BigDecimal的默认构造方法是如果你不指定传入的数字类型，默认是double类型，</span></span><br><span class="line"><span class="comment">        所以这里如果不将传入的数字指定为字符串的话会出现精度丢失。</span></span><br><span class="line"><span class="comment">        stripTrailingZeros()不光会去掉小数点后的没用的0，</span></span><br><span class="line"><span class="comment">        如果你的整数位的末尾数字也是0的话，它会将这个整数变成科学计数法，神坑。</span></span><br><span class="line"><span class="comment">        所以这里需要在stripTrailingZeros()方法后，再追加一个toPlainString()方法。</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 业务类型名称  放sql不好转来着。。。</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getBusTpNme</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> DataDictUtil.getNameFromDataDict(DictCode.BUS_TP,<span class="built_in">this</span>.getBusTp());    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 也可以将几个字段拼接成key返回</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getKeyOfProdCdAcctNoCcy</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Optional.ofNullable(getProdCd()).orElse(<span class="string">&quot;&quot;</span>)</span><br><span class="line">                + Optional.ofNullable(getAcctNo()).orElse(<span class="string">&quot;&quot;</span>)</span><br><span class="line">                + Optional.ofNullable(getCcy()).orElse(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="工具包"><a href="#工具包" class="headerlink" title="工具包"></a>工具包</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line">import java.math.BigDecimal;    </span><br><span class="line">  </span><br><span class="line">/**  </span><br><span class="line"> * 进行BigDecimal对象的加减乘除，四舍五入等运算的工具类  </span><br><span class="line"> *  </span><br><span class="line"> */  </span><br><span class="line">public class Arith &#123;    </span><br><span class="line">  </span><br><span class="line">    /**   </span><br><span class="line">    * 由于Java的简单类型不能够精确的对浮点数进行运算，这个工具类提供精   </span><br><span class="line">    * 确的浮点数运算，包括加减乘除和四舍五入。   </span><br><span class="line">    */    </span><br><span class="line">    //默认除法运算精度    </span><br><span class="line">    private static final int DEF_DIV_SCALE = 10;    </span><br><span class="line">           </span><br><span class="line">    //这个类不能实例化    </span><br><span class="line">    private Arith()&#123;    </span><br><span class="line">    &#125;    </span><br><span class="line">  </span><br><span class="line">    /**   </span><br><span class="line">     * 提供精确的加法运算。   </span><br><span class="line">     * @param v1 被加数   </span><br><span class="line">     * @param v2 加数   </span><br><span class="line">     * @return 两个参数的和   </span><br><span class="line">     */    </span><br><span class="line">    public static double add(double v1,double v2)&#123;    </span><br><span class="line">        BigDecimal b1 = new BigDecimal(Double.toString(v1));    </span><br><span class="line">        BigDecimal b2 = new BigDecimal(Double.toString(v2));    </span><br><span class="line">        return b1.add(b2).doubleValue();    </span><br><span class="line">    &#125;    </span><br><span class="line">       </span><br><span class="line">    /**   </span><br><span class="line">     * 提供精确的减法运算。   </span><br><span class="line">     * @param v1 被减数   </span><br><span class="line">     * @param v2 减数   </span><br><span class="line">     * @return 两个参数的差   </span><br><span class="line">     */    </span><br><span class="line">    public static double sub(double v1,double v2)&#123;    </span><br><span class="line">        BigDecimal b1 = new BigDecimal(Double.toString(v1));    </span><br><span class="line">        BigDecimal b2 = new BigDecimal(Double.toString(v2));    </span><br><span class="line">        return b1.subtract(b2).doubleValue();    </span><br><span class="line">    &#125;    </span><br><span class="line">       </span><br><span class="line">    /**   </span><br><span class="line">     * 提供精确的乘法运算。   </span><br><span class="line">     * @param v1 被乘数   </span><br><span class="line">     * @param v2 乘数   </span><br><span class="line">     * @return 两个参数的积   </span><br><span class="line">     */    </span><br><span class="line">    public static double mul(double v1,double v2)&#123;    </span><br><span class="line">        BigDecimal b1 = new BigDecimal(Double.toString(v1));    </span><br><span class="line">        BigDecimal b2 = new BigDecimal(Double.toString(v2));    </span><br><span class="line">        return b1.multiply(b2).doubleValue();    </span><br><span class="line">    &#125;    </span><br><span class="line">  </span><br><span class="line">    /**   </span><br><span class="line">     * 提供（相对）精确的除法运算，当发生除不尽的情况时，精确到   </span><br><span class="line">     * 小数点以后10位，以后的数字四舍五入。   </span><br><span class="line">     * @param v1 被除数   </span><br><span class="line">     * @param v2 除数   </span><br><span class="line">     * @return 两个参数的商   </span><br><span class="line">     */    </span><br><span class="line">    public static double div(double v1,double v2)&#123;    </span><br><span class="line">        return div(v1,v2,DEF_DIV_SCALE);    </span><br><span class="line">    &#125;    </span><br><span class="line">  </span><br><span class="line">    /**   </span><br><span class="line">     * 提供（相对）精确的除法运算。当发生除不尽的情况时，由scale参数指   </span><br><span class="line">     * 定精度，以后的数字四舍五入。   </span><br><span class="line">     * @param v1 被除数   </span><br><span class="line">     * @param v2 除数   </span><br><span class="line">     * @param scale 表示表示需要精确到小数点以后几位。   </span><br><span class="line">     * @return 两个参数的商   </span><br><span class="line">     */    </span><br><span class="line">    public static double div(double v1,double v2,int scale)&#123;    </span><br><span class="line">        if(scale&lt;0)&#123;    </span><br><span class="line">            throw new IllegalArgumentException(    </span><br><span class="line">                &quot;The scale must be a positive integer or zero&quot;);    </span><br><span class="line">        &#125;    </span><br><span class="line">        BigDecimal b1 = new BigDecimal(Double.toString(v1));    </span><br><span class="line">        BigDecimal b2 = new BigDecimal(Double.toString(v2));    </span><br><span class="line">        return b1.divide(b2,scale,BigDecimal.ROUND_HALF_UP).doubleValue();    </span><br><span class="line">    &#125;    </span><br><span class="line">  </span><br><span class="line">    /**   </span><br><span class="line">     * 提供精确的小数位四舍五入处理。   </span><br><span class="line">     * @param v 需要四舍五入的数字   </span><br><span class="line">     * @param scale 小数点后保留几位   </span><br><span class="line">     * @return 四舍五入后的结果   </span><br><span class="line">     */    </span><br><span class="line">    public static double round(double v,int scale)&#123;    </span><br><span class="line">        if(scale&lt;0)&#123;    </span><br><span class="line">            throw new IllegalArgumentException(    </span><br><span class="line">                &quot;The scale must be a positive integer or zero&quot;);    </span><br><span class="line">        &#125;    </span><br><span class="line">        BigDecimal b = new BigDecimal(Double.toString(v));    </span><br><span class="line">        BigDecimal one = new BigDecimal(&quot;1&quot;);    </span><br><span class="line">        return b.divide(one,scale,BigDecimal.ROUND_HALF_UP).doubleValue();    </span><br><span class="line">    &#125;    </span><br><span class="line">       </span><br><span class="line">   /**   </span><br><span class="line">    * 提供精确的类型转换(Float)   </span><br><span class="line">    * @param v 需要被转换的数字   </span><br><span class="line">    * @return 返回转换结果   </span><br><span class="line">    */    </span><br><span class="line">    public static float convertsToFloat(double v)&#123;    </span><br><span class="line">        BigDecimal b = new BigDecimal(v);    </span><br><span class="line">        return b.floatValue();    </span><br><span class="line">    &#125;    </span><br><span class="line">       </span><br><span class="line">    /**   </span><br><span class="line">    * 提供精确的类型转换(Int)不进行四舍五入   </span><br><span class="line">    * @param v 需要被转换的数字   </span><br><span class="line">    * @return 返回转换结果   </span><br><span class="line">    */    </span><br><span class="line">    public static int convertsToInt(double v)&#123;    </span><br><span class="line">        BigDecimal b = new BigDecimal(v);    </span><br><span class="line">        return b.intValue();    </span><br><span class="line">    &#125;    </span><br><span class="line">  </span><br><span class="line">    /**   </span><br><span class="line">    * 提供精确的类型转换(Long)   </span><br><span class="line">    * @param v 需要被转换的数字   </span><br><span class="line">    * @return 返回转换结果   </span><br><span class="line">    */    </span><br><span class="line">    public static long convertsToLong(double v)&#123;    </span><br><span class="line">        BigDecimal b = new BigDecimal(v);    </span><br><span class="line">        return b.longValue();    </span><br><span class="line">    &#125;    </span><br><span class="line">  </span><br><span class="line">    /**   </span><br><span class="line">    * 返回两个数中大的一个值   </span><br><span class="line">    * @param v1 需要被对比的第一个数   </span><br><span class="line">    * @param v2 需要被对比的第二个数   </span><br><span class="line">    * @return 返回两个数中大的一个值   </span><br><span class="line">    */    </span><br><span class="line">    public static double returnMax(double v1,double v2)&#123;    </span><br><span class="line">        BigDecimal b1 = new BigDecimal(v1);    </span><br><span class="line">        BigDecimal b2 = new BigDecimal(v2);    </span><br><span class="line">        return b1.max(b2).doubleValue();    </span><br><span class="line">    &#125;    </span><br><span class="line">  </span><br><span class="line">    /**   </span><br><span class="line">    * 返回两个数中小的一个值   </span><br><span class="line">    * @param v1 需要被对比的第一个数   </span><br><span class="line">    * @param v2 需要被对比的第二个数   </span><br><span class="line">    * @return 返回两个数中小的一个值   </span><br><span class="line">    */    </span><br><span class="line">    public static double returnMin(double v1,double v2)&#123;    </span><br><span class="line">        BigDecimal b1 = new BigDecimal(v1);    </span><br><span class="line">        BigDecimal b2 = new BigDecimal(v2);    </span><br><span class="line">        return b1.min(b2).doubleValue();    </span><br><span class="line">    &#125;    </span><br><span class="line">  </span><br><span class="line">    /**   </span><br><span class="line">    * 精确对比两个数字   </span><br><span class="line">    * @param v1 需要被对比的第一个数   </span><br><span class="line">    * @param v2 需要被对比的第二个数   </span><br><span class="line">    * @return 如果两个数一样则返回0，如果第一个数比第二个数大则返回1，反之返回-1   </span><br><span class="line">    */    </span><br><span class="line">        public static int compareTo(double v1,double v2)&#123;    </span><br><span class="line">        BigDecimal b1 = new BigDecimal(v1);    </span><br><span class="line">        BigDecimal b2 = new BigDecimal(v2);    </span><br><span class="line">        return b1.compareTo(b2);    </span><br><span class="line">    &#125;   </span><br><span class="line">  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://issac2e.github.io">issac</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://issac2e.github.io/2022/10/16/java%E5%9F%BA%E7%A1%80/%E6%95%B4%E7%90%86%E4%B8%80%E4%B8%8Bdecimal/">https://issac2e.github.io/2022/10/16/java%E5%9F%BA%E7%A1%80/%E6%95%B4%E7%90%86%E4%B8%80%E4%B8%8Bdecimal/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/java%E5%9F%BA%E7%A1%80/">java基础</a></div><div class="post_share"><div class="social-share" data-image="/./img/avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/12/06/mysql/mysql%E5%AD%97%E5%85%B8/" title="Mysql字典，便于梳理知识点"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Mysql字典，便于梳理知识点</div></div></a></div><div class="next-post pull-right"><a href="/2022/02/16/JUC/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" title="深入理解并发编程"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">深入理解并发编程</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/./img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">issac</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/issac2e"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/issac2e" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:issac2e@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">哈哈哈哈哈哈哈哈</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E9%87%91%E9%A2%9D%E5%8D%95%E4%BD%8D%E4%B8%80%E8%88%AC%E5%AD%98%E6%B3%95%EF%BC%9F"><span class="toc-text">数据库中金额单位一般存法？</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%89%E5%B8%81%E7%A7%8D%E5%90%97%EF%BC%9F%E5%A6%82%E6%9E%9C%E8%A6%81%E6%94%AF%E6%8C%81%E5%A4%9A%E5%B8%81%E7%A7%8D%EF%BC%8C%E9%9C%80%E8%A6%81%E5%81%9A%E4%BB%80%E4%B9%88%E6%94%B9%E9%80%A0%E5%90%97%EF%BC%9F"><span class="toc-text">有币种吗？如果要支持多币种，需要做什么改造吗？</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Decimal"><span class="toc-text">Decimal</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81decimal%E5%9C%A8java%E4%B8%AD%E7%9A%84%E7%94%A8BigDecimal%E8%A1%A8%E7%A4%BA%EF%BC%8Cjava-math%E5%8C%85%E4%B8%8B"><span class="toc-text">1、decimal在java中的用BigDecimal表示，java.math包下</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81BigDecimal%E7%B1%BB%E5%9E%8B%E4%B8%8Estring%EF%BC%8CDouble%E7%B1%BB%E5%9E%8B%E7%9A%84%E7%9B%B8%E4%BA%92%E8%BD%AC%E6%8D%A2"><span class="toc-text">2、BigDecimal类型与string，Double类型的相互转换</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81BigDecimal%E6%93%8D%E4%BD%9C%E8%BF%90%E7%AE%97%E5%8A%A0%E5%87%8F%E4%B9%98%E9%99%A4"><span class="toc-text">3、BigDecimal操作运算加减乘除</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4%E7%A6%81%E6%AD%A2%E4%BD%BF%E7%94%A8BigDecimal%E7%9A%84equals%E6%96%B9%E6%B3%95%E5%81%9A%E7%AD%89%E5%80%BC%E6%AF%94%E8%BE%83"><span class="toc-text">4、阿里巴巴禁止使用BigDecimal的equals方法做等值比较</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81%E5%A6%82%E4%BD%95%E6%AF%94%E8%BE%83BigDecimal"><span class="toc-text">5、如何比较BigDecimal</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AF%B4double%E4%B8%8D%E7%B2%BE%E7%A1%AE%EF%BC%9F"><span class="toc-text">6、为什么说double不精确？</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7%E3%80%81BigDecimal%E5%A6%82%E4%BD%95%E7%B2%BE%E7%A1%AE%E8%AE%A1%E6%95%B0%EF%BC%9F"><span class="toc-text">7、BigDecimal如何精确计数？</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#8%E3%80%81%E6%80%BB%E7%BB%93"><span class="toc-text">8、总结</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%B4%B4%E6%AE%B5%E4%BB%A3%E7%A0%81"><span class="toc-text">贴段代码</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7%E5%8C%85"><span class="toc-text">工具包</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/03/17/UofG/itProject_Python/" title="itProject_Python">itProject_Python</a><time datetime="2023-03-17T22:02:08.000Z" title="Created 2023-03-17 22:02:08">2023-03-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/02/14/UofG/Software%20Engineering/" title="Software Engineering">Software Engineering</a><time datetime="2023-02-14T22:02:08.000Z" title="Created 2023-02-14 22:02:08">2023-02-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/02/11/UofG/Advanced%20Programming/" title="Advanced Programming">Advanced Programming</a><time datetime="2023-02-11T22:02:08.000Z" title="Created 2023-02-11 22:02:08">2023-02-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/02/06/Redis/Redis%20%E9%9B%AA%E5%B4%A9%E3%80%81%E5%87%BB%E7%A9%BF%E3%80%81%E7%A9%BF%E9%80%8F%E3%80%81%E9%A2%84%E7%83%AD%E3%80%81%E9%99%8D%E7%BA%A7/" title="Redis 雪崩、击穿、穿透、预热、降级">Redis 雪崩、击穿、穿透、预热、降级</a><time datetime="2023-02-06T22:36:08.000Z" title="Created 2023-02-06 22:36:08">2023-02-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/02/01/UofG/cardGame/" title="Card Game流程梳理">Card Game流程梳理</a><time datetime="2023-02-01T22:02:08.000Z" title="Created 2023-02-01 22:02:08">2023-02-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By issac</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>